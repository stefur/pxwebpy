<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Examples – pxwebpy 0.4.0.post46+g84b9d33.d20251016</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-6c39e09fdfc3dc53c1f951cfe104e44f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-657fc1361c91eea4fb4e96764eaad9ee.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-6c39e09fdfc3dc53c1f951cfe104e44f.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-66de4acf8283af8573aef6d8cf3fd16d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-66de4acf8283af8573aef6d8cf3fd16d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-66de4acf8283af8573aef6d8cf3fd16d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">pxwebpy 0.4.0.post46+g84b9d33.d20251016</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./examples.html" aria-current="page"> 
<span class="menu-text">Examples</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./reference/index.html"> 
<span class="menu-text">Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stefur/pxwebpy" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basic-setup-and-exploration" id="toc-basic-setup-and-exploration" class="nav-link active" data-scroll-target="#basic-setup-and-exploration">Basic setup and exploration</a></li>
  <li><a href="#searching-for-tables" id="toc-searching-for-tables" class="nav-link" data-scroll-target="#searching-for-tables">Searching for tables</a></li>
  <li><a href="#getting-table-metadata" id="toc-getting-table-metadata" class="nav-link" data-scroll-target="#getting-table-metadata">Getting table metadata</a>
  <ul>
  <li><a href="#code-lists" id="toc-code-lists" class="nav-link" data-scroll-target="#code-lists">Code lists</a></li>
  </ul></li>
  <li><a href="#getting-table-data" id="toc-getting-table-data" class="nav-link" data-scroll-target="#getting-table-data">Getting table data</a>
  <ul>
  <li><a href="#loading-into-dataframes" id="toc-loading-into-dataframes" class="nav-link" data-scroll-target="#loading-into-dataframes">Loading into dataframes</a></li>
  <li><a href="#using-wildcards" id="toc-using-wildcards" class="nav-link" data-scroll-target="#using-wildcards">Using wildcards</a></li>
  <li><a href="#large-queries-and-batching" id="toc-large-queries-and-batching" class="nav-link" data-scroll-target="#large-queries-and-batching">Large queries and batching</a></li>
  <li><a href="#in-memory-caching" id="toc-in-memory-caching" class="nav-link" data-scroll-target="#in-memory-caching">In-memory caching</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/stefur/pxwebpy/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Examples</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This library provides a Python client for the PxWeb API, but is not affiliated with the PxWeb project. The examples do not go into detail about how the PxWeb API behaves or responds. For more information about the API itself, check out the official <a href="https://github.com/PxTools/PxApiSpecs">specification</a>.</p>
</div>
</div>
<section id="basic-setup-and-exploration" class="level2">
<h2 class="anchored" data-anchor-id="basic-setup-and-exploration">Basic setup and exploration</h2>
<p>The first step is to set up a PxApi object to use.</p>
<div id="5463da72" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pxweb <span class="im">import</span> PxApi</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the builtin known API instead of a URL</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>api <span class="op">=</span> PxApi(<span class="st">"scb"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>api</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>PxApi(url='https://api.scb.se/ov0104/v2beta/api/v2',
        language=sv,
        disable_cache=False,
        timeout=30,
        number_of_tables=5103)</code></pre>
</div>
</div>
<p>We can check out information about the API, including languages supported, by using <a href="./reference/PxApi.html#pxweb.PxApi.get_config" title="0"><code>.get_config()</code></a>.</p>
<div id="268370e7" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>api.get_config()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>{
    'apiVersion': '2.0.0',
    'appVersion': '1.0.0',
    'languages': [
        {
            'id': 'sv',
            'label': 'Svenska'
        },
        {
            'id': 'en',
            'label': 'English'
        }
    ],
    'defaultLanguage': 'sv',
    'maxDataCells': 150000,
    ... +7
}</code></pre>
</div>
</div>
<p>If we want to change the language, we can do so by changing an attribute of the <a href="./reference/PxApi.html#pxweb.PxApi" title="0"><code>PxApi</code></a> object like so: <code>api.language = "en"</code> This will change the response language for all subsequent queries to the API.</p>
<p>From here we can also browse around and get data. Checking out all tables available is doable with <a href="./reference/PxApi.html#pxweb.PxApi.all_tables" title="0"><code>.all_tables()</code></a>, but probably a bit overwhelming.</p>
<div id="7fe52672" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>api.all_tables()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[
    {
        'id': 'TAB4707',
        'label': 'Antal pågående anställningar efter anställningstid'+39,
        'description': '',
        'updated': '2025-09-30T06:00:00Z',
        'firstPeriod': '2015M04',
        ... +8
    },
    {
        'id': 'TAB4714',
        'label': 'Antal pågående anställningar efter anställningstid'+58,
        'description': '',
        'updated': '2025-09-30T06:00:00Z',
        'firstPeriod': '2015M04',
        ... +8
    },
    {
        'id': 'TAB4718',
        'label': 'Antal pågående anställningar efter kön, region och'+30,
        'description': '',
        'updated': '2025-09-30T06:00:00Z',
        'firstPeriod': '2020M01',
        ... +8
    },
    {
        'id': 'TAB4723',
        'label': 'Antal pågående anställningar i näringslivet efter '+56,
        'description': '',
        'updated': '2025-09-30T06:00:00Z',
        'firstPeriod': '2020M01',
        ... +8
    },
    {
        'id': 'TAB4344',
        'label': 'Antal pågående anställningar i näringslivet efter '+65,
        'description': '',
        'updated': '2025-09-30T06:00:00Z',
        'firstPeriod': '2015M04',
        ... +8
    },
    ... +5098
]</code></pre>
</div>
</div>
<p>Tables are organised into subjects and are categorised into different <code>paths</code>. To see all paths available, use <a href="./reference/PxApi.html#pxweb.PxApi.get_paths" title="0"><code>.get_paths()</code></a>.</p>
<div id="bbb7044f" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>api.get_paths()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>[
    {
        'id': 'AA',
        'label': 'Ämnesövergripande statistik'
    },
    {
        'id': 'AA0003',
        'label': 'Registerdata för integration'
    },
    {
        'id': 'AA0003B',
        'label': 'Statistik med inriktning mot arbetsmarknaden'
    },
    {
        'id': 'AA0003C',
        'label': 'Statistik med inriktning mot flyttmönster'
    },
    {
        'id': 'AA0003D',
        'label': 'Statistik med inriktning mot boende'
    },
    ... +830
]</code></pre>
</div>
</div>
<p>It’s also possible to filter the paths, for example to get all paths related to a specific subject like “Befolkning”.</p>
<div id="30e1e8c7" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>api.get_paths(path_id<span class="op">=</span><span class="st">"BE"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>[
    {
        'id': 'BE',
        'label': 'Befolkning'
    },
    {
        'id': 'BE0001',
        'label': 'Namnstatistik'
    },
    {
        'id': 'BE0001D',
        'label': 'Nyfödda – Äldre tabeller som inte längre uppdatera'+1
    },
    {
        'id': 'BE0001G',
        'label': 'Hela befolkningen – Äldre tabeller som inte längre'+11
    },
    {
        'id': 'BE0101',
        'label': 'Befolkningsstatistik'
    },
    ... +29
]</code></pre>
</div>
</div>
<p>To get all tables that are in specific path you can use <a href="./reference/PxApi.html#pxweb.PxApi.tables_on_path" title="0"><code>.tables_on_path()</code></a>. Here we take a closer look at “Folkmängd”.</p>
<div id="b8ffe607" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>api.tables_on_path(path_id<span class="op">=</span><span class="st">"BE0101A"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>[
    {
        'id': 'TAB6471',
        'label': 'Folkmängden per månad efter region, ålder och kön.'+20,
        'paths': [
            [...]
        ]
    },
    {
        'id': 'TAB5444',
        'label': 'Folkmängden per månad efter region, ålder och kön.'+19,
        'paths': [
            [...]
        ]
    },
    {
        'id': 'TAB5890',
        'label': 'Folkmängden efter ålder och kön. År 1860-2024',
        'paths': [
            [...]
        ]
    },
    {
        'id': 'TAB638',
        'label': 'Folkmängden efter region, civilstånd, ålder och kö'+16,
        'paths': [
            [...]
        ]
    },
    {
        'id': 'TAB4537',
        'label': 'Folkmängden per distrikt, landskap, landsdel eller'+30,
        'paths': [
            [...]
        ]
    },
    ... +2
]</code></pre>
</div>
</div>
</section>
<section id="searching-for-tables" class="level2">
<h2 class="anchored" data-anchor-id="searching-for-tables">Searching for tables</h2>
<p>It’s also possible to search for tables using the <a href="./reference/PxApi.html#pxweb.PxApi.search" title="0"><code>.search()</code></a> method.</p>
<div id="34ba71bd" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeping it simple and just look for tables updated in the past 30 days matching the query string</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> api.search(query<span class="op">=</span><span class="st">"energi"</span>, past_days<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking how many tables there are in the results</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(results.get(<span class="st">"tables"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>20</code></pre>
</div>
</div>
<p>We can also get the labels and ID’s, or any other metadata, to find out more.</p>
<div id="665098b0" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>[</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    {k: v <span class="cf">for</span> k, v <span class="kw">in</span> table.items() <span class="cf">if</span> k <span class="kw">in</span> (<span class="st">"id"</span>, <span class="st">"label"</span>)}</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> table <span class="kw">in</span> results.get(<span class="st">"tables"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>[
    {
        'id': 'TAB5918',
        'label': 'Konsumentprisindex med fast ränta exklusive energi'+44
    },
    {
        'id': 'TAB6445',
        'label': 'Snabb-KPI: preliminära förändringstal för KPI, KPI'+49
    },
    {
        'id': 'TAB6394',
        'label': 'Snabb-KPI: preliminära förändringstal för KPI, KPI'+52
    },
    {
        'id': 'TAB4585',
        'label': 'Underliggande inflation (Riksbanken), Index 1987=1'+25
    },
    {
        'id': 'TAB5891',
        'label': 'Tabell 2.35 - Nystartade företag efter näringsgren'+45
    },
    ... +15
]</code></pre>
</div>
</div>
</section>
<section id="getting-table-metadata" class="level2">
<h2 class="anchored" data-anchor-id="getting-table-metadata">Getting table metadata</h2>
<p>There are two methods to get table metadata. You can get the full metadata information by simply calling <a href="./reference/PxApi.html#pxweb.PxApi.get_table_metadata" title="0"><code>.get_table_metadata()</code></a>.</p>
<p>If you’re interested in the details about variables of a table you can also use <a href="./reference/PxApi.html#pxweb.PxApi.get_table_variables" title="0"><code>.get_table_variables()</code></a>. This method returns information in a more condensed way which may be easier to overview.</p>
<div id="d986d80c" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the table ID</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tab_vars <span class="op">=</span> api.get_table_variables(<span class="st">"TAB2706"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's check out Region</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>tab_vars.get(<span class="st">"Region"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>{
    'label': 'region',
    'category': {
        'label': {
            '0114': 'Upplands Väsby',
            '0115': 'Vallentuna',
            '0117': 'Österåker',
            '0120': 'Värmdö',
            '0123': 'Järfälla',
            ... +318
        }
    },
    'elimination': True,
    'codelists': [
        {
            'id': 'vs_RegionKommun07+BaraEjAggr',
            'label': 'Kommuner och Bara kommun (1229) som upphörde 1976'
        },
        {
            'id': 'vs_RegionValkretsTot99',
            'label': 'Totalt, alla redovisade valkretsar'
        },
        {
            'id': 'vs_RegionValkrets99',
            'label': 'Valkretsar'
        }
    ]
}</code></pre>
</div>
</div>
<p>As can be seen above <code>elimination</code> is <code>True</code> for <code>"Region"</code>, so the variable can be skipped over. But there’s also a few code lists associated with the variable.</p>
<section id="code-lists" class="level3">
<h3 class="anchored" data-anchor-id="code-lists">Code lists</h3>
<p>Getting information about code lists can be done with <a href="./reference/PxApi.html#pxweb.PxApi.get_code_list" title="0"><code>.get_code_list()</code></a>.</p>
<div id="a253ce18" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetching and unpacking 'values' of 'vs_RegionValkrets99'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>api.get_code_list(<span class="st">"vs_RegionValkrets99"</span>).get(<span class="st">"values"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>[
    {
        'code': 'VR1',
        'label': 'Stockholms kommuns valkrets',
        'valueMap': [
            'VR1'
        ]
    },
    {
        'code': 'VR2',
        'label': 'Stockholms läns valkrets',
        'valueMap': [
            'VR2'
        ]
    },
    {
        'code': 'VR3',
        'label': 'Uppsala läns valkrets',
        'valueMap': [
            'VR3'
        ]
    },
    {
        'code': 'VR4',
        'label': 'Södermanlands läns valkrets',
        'valueMap': [
            'VR4'
        ]
    },
    {
        'code': 'VR5',
        'label': 'Östergötlands läns valkrets',
        'valueMap': [
            'VR5'
        ]
    },
    ... +26
]</code></pre>
</div>
</div>
<p>The codes can then be used in a query for a selection based on the code list. More on that in <a href="#getting-table-data">Getting table data</a>.</p>
</section>
</section>
<section id="getting-table-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-table-data">Getting table data</h2>
<p>To get data with <a href="./reference/PxApi.html#pxweb.PxApi.get_table_data" title="0"><code>.get_table_data()</code></a> we need a few things.</p>
<ul>
<li>A table ID</li>
<li>A selection of value codes from variables</li>
<li>A code list (optional)</li>
</ul>
<div id="5d74199a" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting some election results for specific regions, using a code list to match value codes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> api.get_table_data(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TAB2706"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    value_codes<span class="op">=</span>{</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ContentsCode"</span>: <span class="st">"ME0104B6"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tid"</span>: <span class="st">"2022"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Region"</span>: [<span class="st">"VR2"</span>, <span class="st">"VR3"</span>],</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Partimm"</span>: [</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"M"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"C"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"FP"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"KD"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MP"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"S"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"V"</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SD"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ÖVRIGA"</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"OGILTIGA"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"VALSKOLKARE"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    code_list<span class="op">=</span>{<span class="st">"Region"</span>: <span class="st">"vs_RegionValkrets99"</span>},</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># A finished dataset looks like this</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>dataset</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>[
    {
        'region': 'VR2 Stockholms läns valkrets',
        'parti mm': 'Moderaterna',
        'tabellinnehåll': 'Antal röster',
        'valår': '2022',
        'value': 197466
    },
    {
        'region': 'VR2 Stockholms läns valkrets',
        'parti mm': 'Centerpartiet',
        'tabellinnehåll': 'Antal röster',
        'valår': '2022',
        'value': 60776
    },
    {
        'region': 'VR2 Stockholms läns valkrets',
        'parti mm': 'Liberalerna',
        'tabellinnehåll': 'Antal röster',
        'valår': '2022',
        'value': 48949
    },
    {
        'region': 'VR2 Stockholms läns valkrets',
        'parti mm': 'Kristdemokraterna',
        'tabellinnehåll': 'Antal röster',
        'valår': '2022',
        'value': 40207
    },
    {
        'region': 'VR2 Stockholms läns valkrets',
        'parti mm': 'Miljöpartiet',
        'tabellinnehåll': 'Antal röster',
        'valår': '2022',
        'value': 42284
    },
    ... +17
]</code></pre>
</div>
</div>
<section id="loading-into-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="loading-into-dataframes">Loading into dataframes</h3>
<p>The native format of the returned dataset can now easily be loaded into a dataframe.</p>
<p>For instance <code>polars</code>:</p>
<div id="c593c826" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(dataset)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (22, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">parti mm</th>
<th data-quarto-table-cell-role="th">tabellinnehåll</th>
<th data-quarto-table-cell-role="th">valår</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="even">
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"VR2 Stockholms läns valkrets"</td>
<td>"Moderaterna"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>197466</td>
</tr>
<tr class="even">
<td>"VR2 Stockholms läns valkrets"</td>
<td>"Centerpartiet"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>60776</td>
</tr>
<tr class="odd">
<td>"VR2 Stockholms läns valkrets"</td>
<td>"Liberalerna"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>48949</td>
</tr>
<tr class="even">
<td>"VR2 Stockholms läns valkrets"</td>
<td>"Kristdemokraterna"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>40207</td>
</tr>
<tr class="odd">
<td>"VR2 Stockholms läns valkrets"</td>
<td>"Miljöpartiet"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>42284</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"VR3 Uppsala läns valkrets"</td>
<td>"Vänsterpartiet"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>19543</td>
</tr>
<tr class="even">
<td>"VR3 Uppsala läns valkrets"</td>
<td>"Sverigedemokraterna"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>45237</td>
</tr>
<tr class="odd">
<td>"VR3 Uppsala läns valkrets"</td>
<td>"övriga partier"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>4134</td>
</tr>
<tr class="even">
<td>"VR3 Uppsala läns valkrets"</td>
<td>"ogiltiga valsedlar"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>2410</td>
</tr>
<tr class="odd">
<td>"VR3 Uppsala läns valkrets"</td>
<td>"ej röstande"</td>
<td>"Antal röster"</td>
<td>"2022"</td>
<td>40954</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>But also <code>pandas</code> and <code>pyarrow</code>:</p>
<div id="8b3454a3" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(dataset)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">parti mm</th>
<th data-quarto-table-cell-role="th">tabellinnehåll</th>
<th data-quarto-table-cell-role="th">valår</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Moderaterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>197466</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Centerpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>60776</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Liberalerna</td>
<td>Antal röster</td>
<td>2022</td>
<td>48949</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Kristdemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>40207</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Miljöpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>42284</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Socialdemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>223056</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Vänsterpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>51623</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>VR2 Stockholms läns valkrets</td>
<td>Sverigedemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>144315</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>VR2 Stockholms läns valkrets</td>
<td>övriga partier</td>
<td>Antal röster</td>
<td>2022</td>
<td>13836</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>VR2 Stockholms läns valkrets</td>
<td>ogiltiga valsedlar</td>
<td>Antal röster</td>
<td>2022</td>
<td>7695</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>VR2 Stockholms läns valkrets</td>
<td>ej röstande</td>
<td>Antal röster</td>
<td>2022</td>
<td>176249</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Moderaterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>45457</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Centerpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>18040</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Liberalerna</td>
<td>Antal röster</td>
<td>2022</td>
<td>12465</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Kristdemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>14766</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Miljöpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>16750</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Socialdemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>72499</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Vänsterpartiet</td>
<td>Antal röster</td>
<td>2022</td>
<td>19543</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>VR3 Uppsala läns valkrets</td>
<td>Sverigedemokraterna</td>
<td>Antal röster</td>
<td>2022</td>
<td>45237</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>VR3 Uppsala läns valkrets</td>
<td>övriga partier</td>
<td>Antal röster</td>
<td>2022</td>
<td>4134</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>VR3 Uppsala läns valkrets</td>
<td>ogiltiga valsedlar</td>
<td>Antal röster</td>
<td>2022</td>
<td>2410</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>VR3 Uppsala läns valkrets</td>
<td>ej röstande</td>
<td>Antal röster</td>
<td>2022</td>
<td>40954</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="705a28ef" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow <span class="im">as</span> pa</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>pa.Table.from_pylist(dataset)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>pyarrow.Table
region: string
parti mm: string
tabellinnehåll: string
valår: string
value: int64
----
region: [["VR2 Stockholms läns valkrets","VR2 Stockholms läns valkrets","VR2 Stockholms läns valkrets","VR2 Stockholms läns valkrets","VR2 Stockholms läns valkrets",...,"VR3 Uppsala läns valkrets","VR3 Uppsala läns valkrets","VR3 Uppsala läns valkrets","VR3 Uppsala läns valkrets","VR3 Uppsala läns valkrets"]]
parti mm: [["Moderaterna","Centerpartiet","Liberalerna","Kristdemokraterna","Miljöpartiet",...,"Vänsterpartiet","Sverigedemokraterna","övriga partier","ogiltiga valsedlar","ej röstande"]]
tabellinnehåll: [["Antal röster","Antal röster","Antal röster","Antal röster","Antal röster",...,"Antal röster","Antal röster","Antal röster","Antal röster","Antal röster"]]
valår: [["2022","2022","2022","2022","2022",...,"2022","2022","2022","2022","2022"]]
value: [[197466,60776,48949,40207,42284,...,19543,45237,4134,2410,40954]]</code></pre>
</div>
</div>
</section>
<section id="using-wildcards" class="level3">
<h3 class="anchored" data-anchor-id="using-wildcards">Using wildcards</h3>
<p>Wildcards are useful, and here is an example using wildcards for a larger query.</p>
<div id="cfffa6e0" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using wildcards here to get all the municipalities in Stockholm, all months of 2024, all genders and 5-year age groups.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The somewhat cryptic ContentsCode represents count</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>population_data <span class="op">=</span> api.get_table_data(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TAB5444"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    value_codes<span class="op">=</span>{</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Alder"</span>: <span class="st">"*"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Region"</span>: <span class="st">"01*"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tid"</span>: <span class="st">"2024*"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Kon"</span>: <span class="st">"*"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ContentsCode"</span>: <span class="st">"000003O5"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    code_list<span class="op">=</span>{<span class="st">"Alder"</span>: <span class="st">"agg_Ålder5år"</span>, <span class="st">"Region"</span>: <span class="st">"vs_RegionKommun07"</span>},</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># This returns over ten thousand rows of data</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(population_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>13728</code></pre>
</div>
</div>
</section>
<section id="large-queries-and-batching" class="level3">
<h3 class="anchored" data-anchor-id="large-queries-and-batching">Large queries and batching</h3>
<p>pxwebpy allows for very large queries by using automatic batching to stay within the rate limits of the API.</p>
<p>Consider the following query for population per year (<code>"TAB1267"</code>):</p>
<div id="aa14ae77" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>codes <span class="op">=</span> {<span class="st">"ContentsCode"</span>: <span class="st">"BE0101A9"</span>, <span class="st">"Region"</span>: <span class="st">"*"</span>, <span class="st">"Alder"</span>: <span class="st">"*"</span>, <span class="st">"Kon"</span>: <span class="st">"*"</span>, <span class="st">"Tid"</span>: <span class="st">"*"</span>}</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>lists <span class="op">=</span> {<span class="st">"Region"</span>: <span class="st">"vs_RegionKommun07"</span>, <span class="st">"Alder"</span>: <span class="st">"vs_Ålder1årA"</span>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This query would produce over 1 million data cells, overshooting the data cell limit of the API (150 000 in this case).</p>
<p>To handle this pxwebpy will break up the query into several subqueries to stay within the limit of data cells while also respecting the rate limit of the number of queries allowed within a give time window. Calls are multithreaded to fetch results as fast as possible.</p>
<div id="a3dbefe2" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Executing the large query</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> api.get_table_data(<span class="st">"TAB1267"</span>, value_codes<span class="op">=</span>codes, code_list<span class="op">=</span>lists)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># And then loading the result into a dataframe</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1_347_340, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">ålder</th>
<th data-quarto-table-cell-role="th">kön</th>
<th data-quarto-table-cell-role="th">tabellinnehåll</th>
<th data-quarto-table-cell-role="th">år</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="even">
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"0114 Upplands Väsby"</td>
<td>"0 år"</td>
<td>"män"</td>
<td>"Antal"</td>
<td>"2002"</td>
<td>207</td>
</tr>
<tr class="even">
<td>"0114 Upplands Väsby"</td>
<td>"0 år"</td>
<td>"män"</td>
<td>"Antal"</td>
<td>"2003"</td>
<td>218</td>
</tr>
<tr class="odd">
<td>"0114 Upplands Väsby"</td>
<td>"0 år"</td>
<td>"män"</td>
<td>"Antal"</td>
<td>"2004"</td>
<td>188</td>
</tr>
<tr class="even">
<td>"0114 Upplands Väsby"</td>
<td>"0 år"</td>
<td>"män"</td>
<td>"Antal"</td>
<td>"2005"</td>
<td>201</td>
</tr>
<tr class="odd">
<td>"0114 Upplands Väsby"</td>
<td>"0 år"</td>
<td>"män"</td>
<td>"Antal"</td>
<td>"2006"</td>
<td>218</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"2584 Kiruna"</td>
<td>"100+ år"</td>
<td>"kvinnor"</td>
<td>"Antal"</td>
<td>"2020"</td>
<td>2</td>
</tr>
<tr class="even">
<td>"2584 Kiruna"</td>
<td>"100+ år"</td>
<td>"kvinnor"</td>
<td>"Antal"</td>
<td>"2021"</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"2584 Kiruna"</td>
<td>"100+ år"</td>
<td>"kvinnor"</td>
<td>"Antal"</td>
<td>"2022"</td>
<td>1</td>
</tr>
<tr class="even">
<td>"2584 Kiruna"</td>
<td>"100+ år"</td>
<td>"kvinnor"</td>
<td>"Antal"</td>
<td>"2023"</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"2584 Kiruna"</td>
<td>"100+ år"</td>
<td>"kvinnor"</td>
<td>"Antal"</td>
<td>"2024"</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="in-memory-caching" class="level3">
<h3 class="anchored" data-anchor-id="in-memory-caching">In-memory caching</h3>
<p>By default <code>pxwebpy</code> uses in-memory caching for API responses, which can be useful for exploration and iterative use. Caching both reduces the load on the API and speeds up execution. However it can be turned off if needed simply by setting the attribute <code>disable_cache</code> to <code>True</code>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/stefur/pxwebpy/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>